(this["webpackJsonpweb-app"]=this["webpackJsonpweb-app"]||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),r=n(20),i=n.n(r),c=(n(27),n(4)),o=n(5),u=n(7),l=n(6),j=(n(28),n(16)),h=n.n(j),b=n(21),d="http://project-4-sem.std-962.ist.mospolytech.ru/api",p=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getStudents",value:function(){var e=Object(b.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d+"/students/",e.next=3,fetch("http://project-4-sem.std-962.ist.mospolytech.ru/api/students/",{method:"GET",headers:{Authorization:"Token ".concat(sessionStorage.token)}}).then((function(e){return e.json()}));case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getStudent",value:function(e){var t=d+"/students/".concat(e);return fetch(t).then((function(e){return e.json()}))}}]),n}(a.a.Component),m=n(1),f=new p,O=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).state={students:[]},s}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;f.getStudents().then((function(t){e.setState({students:t.data})}))}},{key:"getStatus",value:function(e){var t;switch(e){case"q":t="\u0417\u0430\u0447\u0438\u0441\u043b\u0435\u043d \u043d\u0430";break;case"y":t="\u0423\u0447\u0438\u0442\u0441\u044f \u043d\u0430";break;case"a":t="\u0420\u0435\u0448\u0430\u0435\u0442\u0441\u044f \u043e\u0431 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u043d\u0430";break;case"n":t="\u041e\u0442\u0447\u0438\u0441\u043b\u0435\u043d \u043f\u043e\u0441\u043b\u0435"}return t}},{key:"render",value:function(){var e=this;return Object(m.jsxs)("main",{className:"container",children:[Object(m.jsx)("h2",{children:"\u0421\u043f\u0438\u0441\u043e\u043a \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432"}),Object(m.jsx)("ul",{children:this.state.students.map((function(t){return Object(m.jsxs)("li",{children:["#",t.id,": ",t.name," ",t.surname,Object(m.jsx)("br",{}),e.getStatus(t.status)," ",t.course," \u043a\u0443\u0440\u0441\u0435"]},t.id)}))})]})}}]),n}(a.a.Component),v=n(11),g=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).logout=function(e){e.preventDefault(),sessionStorage.removeItem("token"),sessionStorage.removeItem("username"),sessionStorage.removeItem("is_staff"),sessionStorage.removeItem("is_superuser"),setTimeout((function(){window.location.reload()}),100)},e}return Object(o.a)(n,[{key:"render",value:function(){return Object(m.jsx)("header",{children:Object(m.jsxs)("nav",{className:"navbar navbar-expand navbar-light bg-light",children:[Object(m.jsx)("a",{href:"#brand",className:"navbar-brand",children:"AllStudents"}),Object(m.jsxs)("ul",{className:"navbar-nav mr-auto",children:[Object(m.jsx)("li",{className:"nav-link",children:Object(m.jsx)(v.b,{className:"nav-item nav-link",to:"/Main",children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"})}),Object(m.jsx)("li",{className:"nav-link",children:Object(m.jsx)(v.b,{className:"nav-item nav-link",to:"/ApiTest",children:"ApiTest"})}),Object(m.jsx)("li",{className:"nav-link",children:Object(m.jsx)("a",{className:"nav-item nav-link",href:"#logout",onClick:this.logout,children:"\u0412\u044b\u0439\u0442\u0438"})}),Object(m.jsx)("li",{className:"nav-link",children:Object(m.jsx)("a",{className:"nav-item nav-link",href:"http://localhost:8000/students/",children:"RestAPI"})})]})]})})}}]),n}(a.a.Component),k=n(2),x=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(m.jsx)("h1",{children:"\u041e\u0442\u0434\u0435\u043b \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u0430"})}}]),n}(a.a.Component),S=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(m.jsx)("h1",{children:"\u041e\u0442\u0434\u0435\u043b \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u0440\u043e\u0430"})}}]),n}(a.a.Component),y=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(m.jsxs)("main",{className:"container",children:[Object(m.jsx)("h2",{children:"\u041c\u043e\u0439 \u043f\u0440\u043e\u0435\u043a\u0442"}),!0===this.props.is_staff?Object(m.jsx)(x,{}):null,!0===this.props.is_superuser?Object(m.jsx)(S,{}):null]})}}]),n}(a.a.Component),I=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).login=function(e){e.preventDefault(),fetch("".concat(s.props.url,"auth/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s.state.credentials)}).then((function(e){return e.json()})).then((function(e){console.log(e.token),s.setState({data:e}),null===e.token&&void 0===e.token||sessionStorage.setItem("token",e.token)})).catch((function(e){return console.error(e)})),null===sessionStorage.getItem("token")&&void 0===sessionStorage.getItem("token")&&""===sessionStorage.getItem("token")||(s.props.history.push("/Main"),setTimeout((function(){window.location.reload()}),200))},s.inputChange=function(e){var t=s.state.credentials;t[e.target.name]=e.target.value,s.setState({credentials:t}),sessionStorage.setItem("username",t.username)},s.state={credentials:{username:"",password:""},data:{}},s}return Object(o.a)(n,[{key:"render",value:function(){return Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:"\u0412\u043e\u0439\u0434\u0438\u0442\u0435"}),Object(m.jsxs)("form",{children:[Object(m.jsxs)("label",{children:["\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",Object(m.jsx)("input",{type:"text",name:"username",value:this.state.credentials.username,onChange:this.inputChange})]}),Object(m.jsxs)("label",{children:["\u041f\u0430\u0440\u043e\u043b\u044c:",Object(m.jsx)("input",{type:"password",name:"password",value:this.state.credentials.password,onChange:this.inputChange})]}),Object(m.jsx)("button",{onClick:this.login,children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}}]),n}(a.a.Component),C=Object(k.f)(I),w=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).onChangeToken=function(e){s.setState(e)},s.getPermissions=function(e){fetch("".concat(s.state.url,"api/users/"),{method:"GET",headers:{"Content-type":"application/json",Authorization:"Token ".concat(sessionStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){s.setState({users:e}),s.state.users.map((function(e){e.username===sessionStorage.getItem("username")&&(s.setState({is_staff:e.is_staff}),s.setState({is_superuser:e.is_superuser}))}))}))},s.state={is_logged:!!sessionStorage.getItem("token"),users:[],token:null,is_staff:sessionStorage.getItem("is_staff"),is_superuser:sessionStorage.getItem("is_superuser"),url:"http://project-4-sem.std-962.ist.mospolytech.ru/"},s}return Object(o.a)(n,[{key:"componentDidMount",value:function(){null!==sessionStorage.getItem("token")&&this.getPermissions()}},{key:"render",value:function(){return null===sessionStorage.getItem("token")||void 0===sessionStorage.getItem("token")?Object(m.jsx)(v.a,{children:Object(m.jsx)(C,{token:this.state.token,url:this.state.url})}):Object(m.jsxs)(v.a,{children:[Object(m.jsx)(g,{}),Object(m.jsxs)(k.c,{children:[Object(m.jsx)(k.a,{path:"/Main",children:Object(m.jsx)(y,{is_staff:this.state.is_staff,is_superuser:this.state.is_superuser})}),Object(m.jsx)(k.a,{path:"/ApiTest",children:Object(m.jsx)(O,{url:this.state.url})})]})]})}}]),n}(a.a.Component);i.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(w,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.d7e3f74f.chunk.js.map