{"version":3,"sources":["Api/ApiService.js","Api/ApiTest.js","Components/Header.js","Components/Staff.js","Components/Admin.js","Components/Main.js","Components/LoginForm.js","App.js","index.js"],"names":["URL","ApiService","a","fetch","method","headers","sessionStorage","token","then","res","json","response","id","url","React","Component","apiService","ApiTest","props","state","students","getStudents","setState","data","status","outStat","className","this","map","student","name","surname","getStatus","course","Header","logout","event","preventDefault","removeItem","setTimeout","window","location","reload","href","to","onClick","Staff","Admin","Main","is_staff","is_superuser","Login","login","body","JSON","stringify","credentials","console","log","undefined","setItem","catch","err","error","getItem","history","push","inputChange","cred","target","value","username","password","type","onChange","LoginWithRouter","withRouter","App","onChangeToken","e","getPermissions","users","user","is_logged","LoginForm","path","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2a7a57a8.chunk.js","sourcesContent":["import React from 'react'\r\nconst URL = 'http://localhost:8000/api';\r\n\r\n\r\nexport default class ApiService extends React.Component {\r\n\r\n    async getStudents() {\r\n        let url = URL + '/students/'\r\n        const response = await fetch(url, {\r\n            method: \"GET\", \r\n            headers: {\r\n                'Authorization':`Token ${sessionStorage.token}`,\r\n            }\r\n        })\r\n        .then((res) => res.json())\r\n        // const response = await axios.get(url, {\r\n        //     headers: {\r\n        //         'token':'81f6d7e7a1f4533a1d156d103657b323fe6b922b'\r\n        //     }\r\n        // })\r\n        // .then(res => res.data)\r\n        return response\r\n    }\r\n    getStudent(id) {\r\n        let url = URL + `/students/${id}`;\r\n        return fetch(url)\r\n        .then((res)=> res.json())\r\n    }\r\n}","import React from 'react';\r\nimport ApiService from './ApiService'\r\n\r\nconst apiService = new ApiService();\r\n\r\nexport default class ApiTest extends React.Component {\r\n    constructor (props) {\r\n        super(props)\r\n        this.state = {\r\n            students:[]\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        apiService.getStudents().then(response=> {\r\n            this.setState({students: response.data})\r\n        })\r\n    \r\n    }\r\n\r\n\r\n    getStatus(status) {\r\n        let outStat;\r\n        switch(status) {\r\n            case 'q':\r\n                outStat = 'Зачислен на'\r\n                break\r\n            case 'y':\r\n                outStat = 'Учится на'\r\n                break\r\n            case 'a':\r\n                outStat = 'Решается об обучении на'\r\n                break\r\n            case 'n':\r\n                outStat = 'Отчислен после'\r\n                break\r\n            default:\r\n                break\r\n        }\r\n        return outStat\r\n    }\r\n\r\n    render()  {\r\n        return (\r\n            <main className='container'>\r\n                <h2>Список студентов</h2>\r\n                <ul>\r\n                {this.state.students.map((student)=>\r\n                    <li key={student.id}>\r\n                        #{student.id}: {student.name} {student.surname}<br/>\r\n                        {this.getStatus(student.status)} {student.course} курсе\r\n                    </li>\r\n                )}\r\n                </ul>\r\n            </main>\r\n        )\r\n    }\r\n}","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\n\r\nexport default class Header extends React.Component {\r\n\r\n    logout = event => {\r\n        event.preventDefault();\r\n        sessionStorage.removeItem('token')\r\n        sessionStorage.removeItem('username')\r\n        sessionStorage.removeItem('is_staff')\r\n        sessionStorage.removeItem('is_superuser')\r\n        setTimeout(()=> {\r\n            window.location.reload()\r\n        },100)\r\n    }\r\n\r\n    render() {return(\r\n        <header>\r\n            <nav className='navbar navbar-expand navbar-light bg-light'>\r\n                <a href='#brand' className='navbar-brand'>AllStudents</a>\r\n                <ul className='navbar-nav mr-auto'>\r\n                    <li className='nav-link'>\r\n                        <Link className='nav-item nav-link' to='/Main'>Главная</Link>\r\n                    </li>\r\n                    <li className='nav-link'>\r\n                        <Link className='nav-item nav-link' to='/ApiTest'>ApiTest</Link>\r\n                    </li>\r\n                    <li className='nav-link'>\r\n                        <a className='nav-item nav-link' href='#logout' onClick={this.logout}>Выйти</a>\r\n                    </li>\r\n                    <li className='nav-link'>\r\n                        <a className='nav-item nav-link' href='http://localhost:8000/students/'>RestAPI</a>\r\n                    </li>\r\n                </ul>\r\n            </nav>\r\n        </header>\r\n    )}\r\n}","import React from 'react';\r\n\r\nexport default class Staff extends React.Component { \r\n    render(){\r\n    return(\r\n        <h1>Отдел персонала</h1>\r\n    )}\r\n}","import React from 'react'\r\n\r\nexport default class Admin extends React.Component {\r\n    render(){\r\n        return(\r\n            <h1>Отдел администратроа</h1>\r\n        )\r\n    }\r\n}","import React from 'react'\r\nimport Staff from './Staff'\r\nimport Admin from './Admin'\r\n\r\nexport default class Main extends React.Component {\r\n    render() {\r\n        return(\r\n        <main className='container'>\r\n            <h2>Мой проект</h2>\r\n            {this.props.is_staff===true\r\n            ? <Staff/>\r\n            : null\r\n            }\r\n            {this.props.is_superuser===true\r\n            ? <Admin/>\r\n            : null\r\n            }\r\n        </main>\r\n    )}\r\n}","import React from 'react';\r\nimport { withRouter} from 'react-router-dom'\r\nclass Login extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      credentials: {\r\n        username: '',\r\n        password: '',\r\n      },\r\n      data: {},\r\n    }\r\n  }\r\n  login = event => {\r\n    event.preventDefault()\r\n    fetch(`${this.props.url}auth/`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(this.state.credentials)\r\n    })\r\n    .then(res=>res.json())\r\n    .then(res=>{\r\n      console.log(res.token)\r\n      this.setState({data:res})\r\n      if(res.token!==null||res.token!==undefined) {\r\n        sessionStorage.setItem('token',res.token)\r\n      }\r\n    })\r\n    .catch(err=>console.error(err))\r\n\r\n\r\n    if(sessionStorage.getItem('token')!==null || sessionStorage.getItem(\"token\")!==undefined || sessionStorage.getItem('token')!=='') {\r\n      this.props.history.push(\"/Main\")\r\n      setTimeout(()=>{\r\n        window.location.reload()\r\n      },200)\r\n    }\r\n  }\r\n\r\n  inputChange = event => {\r\n    let cred = this.state.credentials;\r\n    cred[event.target.name] = event.target.value;\r\n    this.setState({credentials: cred});\r\n    sessionStorage.setItem('username',cred.username)\r\n  }\r\n\r\n  render() {\r\n    return(\r\n    <div>\r\n      <h1>Войдите</h1>\r\n      <form>\r\n        <label>\r\n          Имя пользователя:\r\n          <input \r\n            type='text'\r\n            name=\"username\"\r\n            value={this.state.credentials.username}\r\n            onChange={this.inputChange}\r\n          />\r\n        </label>\r\n        <label>\r\n          Пароль:\r\n          <input\r\n            type=\"password\"\r\n            name=\"password\"\r\n            value={this.state.credentials.password} \r\n            onChange={this.inputChange}\r\n          />\r\n        </label>\r\n        <button onClick={this.login}>Войти</button>\r\n      </form>\r\n    </div>\r\n  )}\r\n}\r\n\r\nconst LoginWithRouter = withRouter(Login)\r\nexport default LoginWithRouter","import React from 'react'\r\nimport './App.css';\r\nimport ApiTest from'./Api/ApiTest'\r\nimport Header from './Components/Header'\r\nimport {BrowserRouter as Router, Route, Switch } from 'react-router-dom';\r\nimport Main from './Components/Main';\r\nimport LoginForm from './Components/LoginForm';\r\n\r\nclass App extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      is_logged: sessionStorage.getItem('token') ? true: false,\r\n      users: [],\r\n      token: null,\r\n      is_staff: sessionStorage.getItem('is_staff'),\r\n      is_superuser: sessionStorage.getItem('is_superuser'),\r\n      url: 'http://localhost:8000/'\r\n    }\r\n  }\r\n  onChangeToken = e => {\r\n    this.setState(e)\r\n  }\r\n  getPermissions = event => {\r\n    fetch(`${this.state.url}api/users/`,{\r\n      method: \"GET\",\r\n      headers: {\r\n        'Content-type' :'application/json',\r\n        'Authorization': `Token ${sessionStorage.getItem('token')}`\r\n      }\r\n    })\r\n    .then(res => res.json())\r\n    .then(res=>{\r\n      this.setState({users:res})\r\n      this.state.users.map(user=>{\r\n          if(user.username===sessionStorage.getItem('username')) {\r\n            this.setState({'is_staff':user.is_staff})\r\n            this.setState({'is_superuser':user.is_superuser})\r\n        }\r\n      })\r\n    })\r\n\r\n  }\r\n  componentDidMount() {\r\n    if(sessionStorage.getItem('token')!==null){\r\n      this.getPermissions()\r\n    }\r\n  }\r\n  render() {\r\n    if(sessionStorage.getItem('token')===null||sessionStorage.getItem('token')===undefined) {\r\n      return (\r\n      <Router>\r\n        <LoginForm \r\n          token={this.state.token}\r\n          url={this.state.url}\r\n        />\r\n      </Router>\r\n      )\r\n    } else {\r\n    return(\r\n    <Router>\r\n      <Header/>\r\n      <Switch>\r\n      <Route path='/Main'>\r\n          <Main\r\n            is_staff={this.state.is_staff}\r\n            is_superuser={this.state.is_superuser}\r\n          />\r\n        </Route>\r\n        <Route path='/ApiTest'>\r\n          <ApiTest\r\n            url = {this.state.url}\r\n          />\r\n        </Route>\r\n      </Switch>\r\n    </Router> \r\n  )}}\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}